<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="Basic.css">
    <link rel="stylesheet" type="text/css" href="css/Donut-Order.css">
    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <!-- Header Icon -->
    <link rel="icon" type="image/x-icon" href="img/icon.ico" />
    <title>健康優烘焙坊</title>
</head>
<body class="cursor-hover">
    <label class="Now-Order-Title"></label>
    <label class="Now-Order-Title-Price"></label>
    <div><form class="Count-Box"></form></div>
    <script>
        // all name
        var name_EN = ["Original", "RedBean", "Taro", "Sauerkraut", "chocolate"];
        var name_CH = ["原味甜甜圈", "紅豆甜甜圈", "芋頭甜甜圈", "酸菜甜甜圈", "巧克力卡士達甜甜圈"];
        var search = $(location).attr('search');
        var searchprice = search.substr(search.lastIndexOf("&"));
        // alert(search);
        // alert(search.substring(7));
        // alert(search.substr(1, search.lastIndexOf("&") - 1));
        // alert(searchprice.substring(1));
        var ordername = search.substr(1, search.lastIndexOf("&") - 1), orderprice = searchprice.substring(1);
        ordername = ordername.substring(6), orderprice = orderprice.substring(6);
        // alert(ordername + ', ' + orderprice);
        $(".Now-Order-Title").text(name_CH[name_EN.indexOf(ordername)]);
        $(".Now-Order-Title-Price").text('（單價 '+orderprice+' 元）');
        var top1 = 60, topall = 10, top24 = -57.7, left = 95, Row = 3, MAXI = 15, Now = 0, startcount = 1;
        $(".Now-Order-Title").css("margin-left", left);
        $(".Now-Order-Title-Price").css("margin-left", left);
        for(i = 1; i <= MAXI; i++) {
            if (i != 1 && ((i - 1) % Row) == 0) Now++;
            $(".Count-Box").append(`<label style="margin-top: `+((i % Row) == 1 ? ((i == 1) ? top1 : topall) : top24)+`px; margin-left: `+(left * ((i % (MAXI + 1)) - Now * Row - 0))+`px;"><input type="radio" name="Count" value = "`+i+`"><span>`+i+`</span></label>`);
        }
        $(".Count-Box").append(`<label style="margin-top: 0px; margin-left: `+left+`px;"><input type="radio" name="Count" value = "More"><span>更多數量</span></label>`);
        $(".Count-Box").append(`<span class="Now-Order-Price" style="margin-top: 50px; margin-left: 150px;"></span>`);
        $(".Count-Box").append(`<button class="OK-Submit" style="margin-top: 100px; margin-left: 180px;">確認下單</button>`);
        $(".Count-Box").append(`<div class="More-Count-Box" style="margin-top: -150px; margin-left: 100px;"><input ondrop="return false;" onpaste="return false;" onkeypress="return event.charCode>=48 && event.charCode<=57" class="More-Count-Box-Text" placeholder="填寫您需要的數量" required="" type="text"><span class="More-Count-Box-border"></span></div>`);
        $(".More-Count-Box").hide();
        $("input[name='Count']:eq("+(startcount - 1)+")").prop('checked', true);
        $(".Now-Order-Price").text('總計 '+(orderprice * $("input[name='Count']:eq("+(startcount - 1)+")").val())+' 元');
        $("input[name='Count']").click(function(){
            // alert($(this).val());
            if($(this).val() == "More") {
                // alert($("input[name='Count']:eq("+($(".More-Count-Box-Text").val() - 1)+")").val());
                // alert($(".More-Count-Box-Text").val());
                if ($(".More-Count-Box-Text").val() != "" && $(".More-Count-Box-Text").val() <= 15) {
                    $("input[name='Count']:eq("+($(".More-Count-Box-Text").val() - 1)+")").prop('checked', true);
                    $(".Now-Order-Price").text('總計 '+(orderprice * $(".More-Count-Box-Text").val())+' 元');
                    $(".More-Count-Box-Text").val("");
                } else {
                    $(".More-Count-Box").show();
                    if ($(".More-Count-Box-Text").val() == "") $(".Now-Order-Price").text('總計 '+(orderprice * 0)+' 元');
                    else $(".Now-Order-Price").text('總計 '+(orderprice * $(".More-Count-Box-Text").val()) +' 元');
                }
            } else $(".Now-Order-Price").text('總計 '+(orderprice * $(this).val())+' 元'), $(".More-Count-Box").hide();
        });
        $(".More-Count-Box-Text").change(function(){
            if ($(".More-Count-Box-Text").val() <= 15) {
                $("input[name='Count']:eq("+($(".More-Count-Box-Text").val() - 1)+")").prop('checked', true);
                $(".More-Count-Box").hide();
                $(".Now-Order-Price").text('總計 '+(orderprice * $(".More-Count-Box-Text").val())+' 元');
                $(".More-Count-Box-Text").val("");
            }
            else $(".Now-Order-Price").text('總計 '+(orderprice * $(this).val())+' 元');
        });
    </script>
</body>
</html>